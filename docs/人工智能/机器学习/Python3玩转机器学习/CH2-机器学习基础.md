# 第 2 章 机器学习基础

## 2.1 机器学习的数据

我们使用著名的鸢尾花数据：[https://en.wikipedia.org/wiki/Iris_flower_data_set](https://en.wikipedia.org/wiki/Iris_flower_data_set)
`需要科学上网`

![鸢尾花](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723155844.png)

数据：

![鸢尾花数据](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723160220.png)

数据数字化：

![数据数字化](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723160334.png)

* 数据整体叫数据集（data set）

* 每一行数据称为一个样本（sample）

* 除了最后一列，每一列都表达了样本的一个特征（feature），用 `X` 表示

  ![feature](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723173332.png)

* 最后一列，称为标记（label），用小写的 `y` 表示，原因是它是一个向量，所以小写。

  ![image-20200723215746970](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723215748.png)

> 📃 在通常的机器学习任务中，为啥特征用 X 表示呢？

因为通常这部分是一个矩阵，这个矩阵有多少行，就说明我们有多少样本，有多少列，就说明我们有多少个特征，通常我们把第 i 个样本行写作 $X^{(i)}$，第 i 个样本第 j 个特征值写作 $X_j^{(i)}$

![image-20200723220209925](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723220211.png)

为了可视化特征方便，我们只抽取出特征中的前两个特征，其中萼片的长度作为横轴，萼片的宽度作为纵轴。

绘制下图：

![image-20200723220730711](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723220732.png)

对于每一个样本来说，都会在坐标系中表示一个点，假设我们有三个特征，就可以在三维空间中表示它，同理如果有 1000 种特征，就可以在 1000 维空间中表示它，而这个绘制样本的空间我们称它为**特征空间（feature space）**。

通过可视化绘制样本点后，我们可以比较轻易的绘制出一根直线，红色样本在直线的一边而蓝色样本在直线的另一边。

**分类任务本质就是在特征空间切分，在高维空间同理。**

而鸢尾花拥有 4 个特征，应该是在 4 维特征空间中分析。

**特征可以很抽象**

- 图像，每一个像素点都是特征
- 28 * 28 的图像有 28 * 28 = 784 个特征
- 这是灰色图像，如果是彩色图像特征更多

![image-20200723221413074](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723221414.png)

## 2.2 机器学习的基本任务

机器学习关注的基本任务主要有两类：

* （1）分类任务
* （2）回归任务

### 2.2.1 分类任务

分类任务举例，比如区分`猫和狗`，比如上一章所说的`手写输入数字识别`等等。

对于分类任务而言，进一步细分，可以分成这几类任务：

#### ① 二分类任务

二分类（二选一的任务）

* 举例：

* （1）区分猫和狗

  ![image-20200723222700610](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723222702.png)

* （2）判断邮件是垃圾邮件；不是垃圾邮件

* （3）判断发放给客户信用卡有风险；没有风险

* （4）判断病患良性肿瘤；恶性肿瘤

* （5）判断某支股票涨；跌

#### ② 多分类任务

多分类（结果锁定在多个中的一个）

* 举例：

* （1）数字识别

  ![image-20200723223945179](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723223947.png)

* （2）图像识别

* （3）判断发放给客户信用卡的风险评级

* （4）很多复杂的问题，也可以转换成多分类问题

**有很多看似不是分类的任务可以转换为分类任务**，例如，利用机器学习玩 2048 游戏，将玩游戏转换为在当前状态下是进行上移、下移、左移还是右移。

![image-20200723224444202](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723224445.png)

又比如利用机器学习玩围棋，自动驾驶等等童谣可以转换成分类任务来。

!> 注意点：

* 一些算法只支持完成二分类的任务
* 但是多分类的任务可以转换为二分类的任务
* 而有一些算法天然可以完成多分类任务

分类任务除了可以进行二分类任务和多分类任务之外，还可以进行`多标签分类任务`：

#### ③ 多标签分类任务

多标签分类任务，可以识别同一个画面中的多个物体。

![image-20200723225230105](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723225231.png)



### 2.2.2 回归任务

回归任务的特点：结果是一个连续数字的值，而非一个类别

举例：

* 房屋价格：预测房价

  ![image-20200723225933099](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723225934.png)

* 市场分析

* 学生成绩

* 股票价格

> 对于回归任务来说：

* 有些算法只能够解决回归问题；
* 有一些算法只能够解决分类问题；
* 有一些算法的思路既能够解决回归问题，又能解决分类问题。

!> 一些情况下，回归任务可以简化成分类任务。比如，预测学生成绩，我们可能并不需要预测学生的具体成绩而只需要预测学生分数的评级是 A、B、C 还是 D 就足够了，那么此时就是一个分类任务。

> 总结：

机器学习，就是将大量的学习资料喂给机器学习算法后机器学习算法将训练出一个模型，将输入样例输入到模型中得到输出结果，如果模型是输出一个具体的类别，那么我们解决的就是一个分类问题，如果模型输出的是一个具体的数值，那么我们解决的就是一个回归问题。

![image-20200723230855749](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200723230857.png)

## 2.3 机器学习算法的分类

机器学习算法可以分为：

- 监督学习
- 非监督学习
- 半监督学习
- 增强学习

### 2.3.1 监督学习

监督学习：给机器的训练数据拥有“标记”或者“答案”。例如：

![image-20200724104401180](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724104411.png)

我们需要告诉机器左边的画面是一只狗，而右边的照片是一只猫。同理对于 MNIST 数据集，给机器图像信息后还应该附上`标记信息`，如图所示：

![image-20200724105628360](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724105630.png)

运用监督学习的场景举例：

- 图像已经拥有了标定信息
- 银行已经积累了一定的客户信息和他们信用卡的信用信息
- 医院已经积累了一定的病人信息和他们最终确诊是否患病的情况
- 市场积累了房屋的基本信息和最终成交的金额
- ......

监督学习一般处理两大任务：分类和回归。

> 此课程中学习的大部分算法，属于监督学习算法：

- K 近邻
- 线性回归和多项式回归
- 逻辑回归
- SVM
- 决策树和随机森林

!> 注意：很多非监督学习的核心就是辅助监督学习的。

### 2.3.2 非监督学习

非监督学习：给机器训练数据没有任何“标记”或者“答案”。

![image-20200724111352052](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724111353.png)

#### ① 聚类分析

**聚类分析**：对没有“标记”的数据进行分类

![image-20200724111821149](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724111823.png)

#### ② 降维处理

非监督学习一个非常重要的作用就是对数据进行降维处理。

- 特征提取：信用卡的信用评级和人的胖瘦无关？无关的特征丢掉（根据经验或者分析）
- 特征压缩：PCA

![image-20200724112308056](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724112309.png)

降维处理的意义：**方便可视化**

![image-20200724112546860](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724112548.png)

#### ③ 异常检测

非监督学习除了可以进行降维处理，还可以进行异常检测。

![image-20200724112754489](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724112755.png)

如图所示：图中两个红点明显与其他点脱离，如果它们同属于一种数据，我们可以将这两个点归类为`异常`，将其去除。当然图中为二维点，在高维中我们会使用相应的算法剔除异常数据。

### 2.3.3 半监督学习

半监督学习：一部分数据有“标记”或者“答案”，另一部分没有

相对于监督学习，更常见的是各种原因产生的标记缺失的半监督学习。

通常都先使用无监督学习手段对数据做处理，之后使用监督学习手段作模型的训练和预测。

### 2.3.4 增强学习

**增强学习**：根据周围环境的情况，采取行动，根据采取行动的结果，学习行动方式。

![image-20200724171949064](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724171950.png)

**增强学习**非常适合无人驾驶、机器人任务，阿尔法狗就是增强学习的一个典型应用。

!> 如果想做增强学习方面的任务，监督学习和半监督学习是基础。

## 2.4 机器学习的其他分类

### 2.4.1 在线学习和批量学习（离线学习）

* 批量学习（Batch Learning）
* 在线学习（Online Learning）

#### ① 批量学习  

批量学习，也叫做“离线学习”。

![image-20200724174233718](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724174235.png)

* **优点**：简单
* **问题**：如何适应环境变化？
* 解决方案：定时重新批量学习
* 缺点：
  * （1）每次重新批量学习，运算量巨大；
  * （2）在某些环境变化非常快的情况下，甚至不可能的。

#### ② 在线学习

![image-20200724174312526](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724174313.png)

* 优点：及时反映新的环境变化
* 问题：新的数据带来不好的变化？
* 解决方案：需要加强对数据进行监控
* 其他：也适用于数据量巨大，完全无法批量学习的环境。

### 2.4.2 参数学习和非参数学习

#### ① 参数学习

![image-20200724175137611](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724175138.png)

$f(x) = a * x + b$ 这里，a 和 b 就是参数。

参数学习的特点：一旦学到了参数，就不再需要原有的数据集。

#### ② 非参数学习

非参数学习：不对模型进行过多的统计假设

注意：非参数学习并不等于没有参数！

## 2.5 “哲学”思考

2001 年，微软的论文中有个图，好好理解一下：

![image-20200724180215974](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200724180217.png)

> 🎨 提问：数据即算法？

* 数据确实非常重要
* 数据驱动，高度依赖数据本身的质量

所以要进行：

* 收集更多的数据
* 提高数据质量
* 提高数据的代表性
* 研究更重要的特征，即特征工程

> 提问：算法为王？

![image-20200725094249508](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200725094250.png)

当没有数据的时候，算法也可以为我们生成数据。

> 提问：如何选择机器学习算法？

![image-20200725101611832](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200725101612.png)

选择机器学习算法，根据**奥卡姆的剃刀**原则：简单的就是好的！

但是在机器学习领域，到底什么叫“简单”？机器学习处理的是不确定的世界中的真实的问题，对于很多问题来说并没有标准答案。

**没有免费的午餐定理**

* 可以严格地数学推导出：任意两个算法，他们的期望性能是相同的！
* 具体到某个特定问题，有些算法可能更好。
* 但没有一种算法是绝对比另一种算法好的。
* 告诉我们：
  * （1）脱离具体问题，谈哪个算法好，是没有意义的。
  * （2）在面对一个具体问题的时候，尝试使用多种算法进行对比试验，是必要的。

## 2.6 课程环境搭建

使用集成工具 Anaconda：[Anaconda 安装指南](Python/Anaconda/Anaconda入门指南)

![image-20200727142145422](https://gitee.com/wugenqiang/PictureBed/raw/master/images01/20200727142147.png)

 主要用到里面集成的 Jupyter Notebook！

* 矩阵的处理使用包：

```python
import numpy
```

* 可视化包：

```python
import matplotlib
```

* 机器学习具体函数包：

```python
import sklearn
```

* 提供更高级的数据表格管理包：

```python
import pandas
```

* 综合一下：

```python
import numpy
import matplotlib
import sklearn
import pandas

print("Hello, Machine Learning")
```

下一章进行实战，走起 ~~





